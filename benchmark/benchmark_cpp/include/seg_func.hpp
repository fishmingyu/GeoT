
#include "util.cuh"

template <typename ValueType>
void segscan_sr_tune(std::ofstream &out_file, char *data_name, int nnz, int N, int keys, util::RamArray<Index> &index,
                     util::RamArray<DType> &src, util::RamArray<DType> &dst) {
    float time = 0;
    float gflops = 0;
    time = segscan_sr_test<ValueType, 1, 8, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 8, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 8 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 16, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 16 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 32, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 32 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 1, 64, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 1 << "," << 64 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 8, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 8 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 16, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 16 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 32, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 32 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 2, 64, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 2 << "," << 64 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 8, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 8 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 16, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 16 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 32, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 32 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 4, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 4 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 4, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 4 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 4, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 4 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 4, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 4 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 8, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 8 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 8, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 8 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 8, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 8 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 8, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 8 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 16, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 16 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 16, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 16 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 16, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 16 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 16, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 16 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 32, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 32 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 32, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 32 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 32, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 32 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 32, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 32 << "," << 8 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 64, 1>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 64 << "," << 1 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 64, 2>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 64 << "," << 2 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 64, 4>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 64 << "," << 4 << "," << time <<  "," << gflops << std::endl;
    time = segscan_sr_test<ValueType, 4, 64, 64, 8>(nnz, N, keys, index, src, dst);
    gflops = nnz * N / time / 1e6;
    out_file << data_name << "," << 4 << "," << 64 << "," << 64 << "," << 8 << "," << time <<  "," << gflops << std::endl;
}